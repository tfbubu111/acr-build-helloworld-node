# Docker
# Build and push an image to Azure Container Registry
# https://docs.microsoft.com/azure/devops/pipelines/languages/docker

trigger:
- none

variables:
  containerRegistry: 'a2022acr.azurecr.io'
  imagerepository: 'tfbubuacrbuildhelloworldnode'
  tag: $(Build.BuildId)
  vmImageName: 'ubuntu-latest'

stages:
  - stage: Build 
    displayName: Build stage  
    jobs:
    - job: Build
      displayName: Build
      pool: MSIpool
      steps:
##Use docker to build image and push into acr
      - task: Docker@2
        displayName: Build and push an image to container registry
        inputs:
          containerRegistry: '2022ACR'
          repository: '$(imagerepository)'
          command: 'buildAndPush'
          Dockerfile: '**/Dockerfile'
          tags: '$(tag)'